services:
  corporate-portal:
    build: ./gateway-app
    ports:
      - "8000:5000"
    networks:
      public_net:
      internal_net:
        ipv4_address: 172.20.0.10
    restart: always

  marketing-hub:
    build: ./marketing-app
    ports:
      - "8001:80"
    networks:
      internal_net:
        ipv4_address: 172.20.0.50
    restart: always

  billing-bridge:
    build: ./internal-api
    ports:
      - "8002:8080"
    networks:
      internal_net:
        ipv4_address: 172.20.0.20
    restart: always

  secure-vault:
    build: ./internal-db
    ports:
      - "8003:3306"
    networks:
      internal_net:
        ipv4_address: 172.20.0.30
    restart: always

  backup-node:
    build: ./internal-admin
    ports:
      - "8004:9000"
    networks:
      internal_net:
        ipv4_address: 172.20.0.40
    restart: always

  vulnerable-services:
    build: ./vulnerable-services
    ports:
      - "8005:21"      # FTP
      - "8006:22"      # SSH
      - "8007:23"      # Telnet
      - "8008:80"      # Apache
      - "8009:139"     # SMB NetBIOS
      - "8010:445"     # SMB
      - "8011:8080"    # Python vulnerable web
      - "8012:9000"    # Chisel pivoting
    networks:
      internal_net:
        ipv4_address: 172.20.0.60
    restart: always

networks:
  public_net:
    driver: bridge
  internal_net:
    driver: bridge
    ipam:
      config:
        - subnet: 172.20.0.0/24
